#!/bin/bash

E_NONSUDO=101

[[ $UID -eq -0 ]] || {
	echo "Permission denied!"
	echo "Exiting..."
	exit $E_NONSUDO
}

[[ ! -z "$1" ]] && VS_CURRENCY=$1 || VS_CURRENCY=pkr

[[ ! -z "$2" ]] && PER_PAGE=$2 || PER_PAGE=10

echo ${VS_CURRENCY}
echo ${PER_PAGE}

curl -o coins.json -X 'GET' \
"https://api.coingecko.com/api/v3/coins/markets?vs_currency=${VS_CURRENCY}&order=market_cap_desc&per_page=${PER_PAGE}&page=1&sparkline=false" \
-H 'accept: application/json'

if [[ $? -eq 0 ]]
then
	printf "\tRank\tName\tSymbol\tCurrent Price (USD)\n"
	printf "\t$(jq '.[0] | .market_cap_rank' coins.json"
	SYMBOLS=$(jq '.[] | .symbol' coins.json)
	echo ${SYMBOLS}
#	echo "Checking for NGINX updates..."
#	apt-get upgrade nginx -y
else
	echo "NGINX not found"
	echo "Installing NGINX..."
#	apt-get install nginx -y &> /dev/null
	echo "NGINX installed"
fi
